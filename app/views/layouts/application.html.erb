<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <META http-equiv="content-type" content="text/html; charset=utf-8">

	<TITLE>Everest Editor</TITLE>

  <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track' => true %>
  <%= javascript_include_tag 'application', 'data-turbolinks-track' => true %>
  <%= csrf_meta_tags %>

  <script type="text/javascript">
      $(document).ready(function() {
        $( "#workspace" ).workspace();
        workspace = $( "#workspace" ).workspace("instance");

        $("#addTab").click(function(){
          //require("ace/ext/language_tools");
          window.ace.config.set("basePath", "assets/workspace/src/ace-build")
          workspace.open("","",AceWorkspaceEditor,{ace:window.ace,mode:"ace/mode/cql"})
        });

        $.get("/api/documents").then( function (data) {
          treejson = []
          for (var key in data){
            treejson.push({"id": key, "parent": "#", "text": key})
            for (var i = 0; i < data[key].length; i++){
              if(data[key][i]) {
                treejson.push({"id": key+data[key], "parent": key, "text": data[key][i]})
              }
            }
          }

          $('#jstree').jstree({"core": {
              "data": treejson
            }
          });
        });
       }
      );

  </script>
  <script>
    $(function() {
      $( "#menu" ).menu({
    position: {
      my:'left+10 bottom-15',
      at:'left center'
      }
    });
    });
  </script>

  <script>

  </script>
</head>
<body>

<%= yield %>

</body>
</html>
